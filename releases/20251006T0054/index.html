<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>星級引擎｜申請 AI 入場券</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css?v=20251006T0054" />
</head>
<body>
  <main class="page" id="app">
    <!-- S0｜四格輸入 -->
    <section id="stage-s0" class="stage stage--active" data-stage="s0">
      <div class="stage-panel stage-panel--form">
        <div class="brand-line">
          <img src="logo.png" alt="星級引擎" class="brand-line__logo" />
          <span class="brand-line__text">星級引擎｜脈動智匯</span>
        </div>
        <header class="stage-panel__header stage-panel__header--minimal">
          <span class="stage-tag stage-tag--soft">申請 AI 入場券</span>
        </header>

        <form id="lead-form" class="stage-form" autocomplete="off">
          <div class="form-grid">
            <label class="form-field">
              <span class="form-label">城市</span>
              <input id="city" name="city" type="text" placeholder="例如：台北市" required />
            </label>
            <label class="form-field">
              <span class="form-label">路段</span>
              <input id="route" name="route" type="text" placeholder="例如：信義路四段" required />
            </label>
            <label class="form-field">
              <span class="form-label">門牌</span>
              <input id="number" name="number" type="text" placeholder="例如：99 號" required />
            </label>
            <label class="form-field">
              <span class="form-label">店名</span>
              <input id="name" name="name" type="text" placeholder="例如：星級咖啡館" required />
            </label>
          </div>

          <button id="submit-btn" type="submit" class="btn btn--primary">送出入場券申請</button>
        </form>

        <p class="form-note">填完四格後立即送出入場券申請。</p>
      </div>
    </section>

    <!-- S1｜三秒轉場 -->
    <section id="stage-s1" class="stage" data-stage="s1" hidden>
      <div class="stage-panel stage-panel--transition">
        <div class="brand-line brand-line--compact">
          <img src="logo.png" alt="星級引擎" class="brand-line__logo" />
          <span class="brand-line__text">星級引擎｜脈動智匯</span>
        </div>
        <div class="transition-visual">
          <div class="transition-bar" id="transition-bar"></div>
        </div>
        <div class="transition-copy">
          <h2>已收到資料！正在定位您的店家與商圈…</h2>
          <p>我正在抓取 Google Maps 最新資訊，稍後會自動帶入設定。</p>
          <div class="transition-meta">
            <span id="transition-counter">3</span>
            <small>秒後帶您進入專屬調校</small>
          </div>
          <p id="transition-tip" class="transition-tip" hidden>智能體正在準備提示…</p>
        </div>
      </div>
    </section>

    <!-- S2｜問答設定 -->
    <section id="stage-s2" class="stage" data-stage="s2" hidden>
      <div class="stage-panel stage-panel--quiz">
        <div class="brand-line">
          <img src="logo.png" alt="星級引擎" class="brand-line__logo" />
          <span class="brand-line__text">星級引擎｜脈動智匯</span>
        </div>
        <header class="stage-panel__header stage-panel__header--compact">
          <h2>先幫您客製化風格（約 60 秒）</h2>
          <p class="muted">同時我正在抓取評論與競品資料，完成後會自動帶入結果。</p>
          <p class="muted muted--context" id="quiz-context" hidden>我已定位您的門市，正在蒐集附近的競品與評論。</p>
        </header>

        <form id="quiz-form" class="quiz-form">
          <fieldset class="quiz-group">
            <legend>Q1. 您最想先解決哪一件事？</legend>
            <label class="option option--radio">
              <input type="radio" name="quiz-goal" value="instant_lowstar" required />
              <span class="option__label">立即掌握 1–3★ 低星</span>
            </label>
            <label class="option option--radio">
              <input type="radio" name="quiz-goal" value="save_time" />
              <span class="option__label">省時，一鍵回覆草稿</span>
            </label>
            <label class="option option--radio">
              <input type="radio" name="quiz-goal" value="beat_competitors" />
              <span class="option__label">看我與附近對手差距</span>
            </label>
            <label class="option option--radio">
              <input type="radio" name="quiz-goal" value="weekly_focus" />
              <span class="option__label">幫我列出本週三件事</span>
            </label>
          </fieldset>

          <fieldset class="quiz-group">
            <legend>Q2. 希望回覆語氣？（可複選 1–2 項）</legend>
            <div class="quiz-columns">
              <label class="option option--checkbox">
                <input type="checkbox" name="quiz-tone" value="soothing" />
                <span class="option__label">溫和安撫</span>
              </label>
              <label class="option option--checkbox">
                <input type="checkbox" name="quiz-tone" value="direct_fix" />
                <span class="option__label">直接解決</span>
              </label>
              <label class="option option--checkbox">
                <input type="checkbox" name="quiz-tone" value="authority" />
                <span class="option__label">專業權威</span>
              </label>
              <label class="option option--checkbox">
                <input type="checkbox" name="quiz-tone" value="apology" />
                <span class="option__label">道歉＋補救</span>
              </label>
            </div>
            <p class="helper-text">若不確定，可稍後再答，系統預設「直接解決＋溫和安撫」。</p>
          </fieldset>

          <fieldset class="quiz-group">
            <legend>Q3. 想關注的競品（可略過）</legend>
            <textarea id="quiz-competitors" name="quiz-competitors" rows="3" placeholder="輸入店名或地址；用逗號 / 換行分隔，例如：鼎好鍋物, 阿蘭餃子館"></textarea>
            <p class="helper-text">若留空，系統會依據資料自動挑選 5 家同商圈競品。</p>
          </fieldset>

          <div class="quiz-actions">
            <div class="quiz-buttons">
              <button id="quiz-submit" type="submit" class="btn btn--primary">完成設定</button>
              <button id="quiz-skip" type="button" class="btn btn--ghost">稍後再答</button>
            </div>
            <p id="quiz-error" class="error-text" hidden></p>
          </div>
        </form>
      </div>

      <div class="progress-dock">
        <div class="progress-dock__bar">
          <div id="progress-bar" class="progress-dock__fill" style="width: 0%;"></div>
        </div>
        <div class="progress-dock__meta">
          <span id="progress-label">蒐集 AI 入場券資料… 進度 0%</span>
          <span id="progress-eta" class="muted">正在建立門市資料與評論基準</span>
        </div>
      </div>
    </section>

    <!-- S3｜個人化確認卡 -->
    <section id="stage-s3" class="stage" data-stage="s3" hidden>
      <div class="stage-panel stage-panel--summary">
        <div class="brand-line">
          <img src="logo.png" alt="星級引擎" class="brand-line__logo" />
          <span class="brand-line__text">星級引擎｜脈動智匯</span>
        </div>
        <header class="stage-panel__header stage-panel__header--compact">
          <h2>設定完成，我會依照你的偏好打磨報告。</h2>
          <p class="muted">我正在整合評論、競品與語氣偏好，完成後第一時間通知你。</p>
          <p class="muted muted--context" id="summary-context" hidden>我已鎖定您的門市與城市資料，正在同步競品與評論。</p>
        </header>

        <div class="analysis-card" id="progress-countdown" hidden>
          <div class="analysis-card__badge">
            <div class="analysis-card__icon" aria-hidden="true">AI</div>
            <div class="analysis-card__labels">
              <span class="analysis-card__title">Cognos 顧問待命中</span>
              <span class="analysis-card__status" id="progress-status-label">定位商圈中</span>
            </div>
          </div>
          <div class="analysis-card__content">
            <div class="analysis-card__timer" id="progress-timer">
              <span class="analysis-card__seconds" id="progress-countdown-number">20</span>
              <span class="analysis-card__unit">秒</span>
            </div>
            <div class="analysis-card__waiting" id="progress-waiting" hidden>
              <span class="analysis-card__spinner" aria-hidden="true"></span>
            </div>
            <p id="progress-tip" class="analysis-card__tip">陪你等候：我正把資料排進工作列</p>
          </div>
        </div>

        <div class="summary-card">
          <dl class="summary-list">
            <div>
              <dt>重點目標</dt>
              <dd id="summary-goal">—</dd>
            </div>
            <div>
              <dt>回覆語氣</dt>
              <dd id="summary-tone">—</dd>
            </div>
            <div>
              <dt>指定競品</dt>
              <dd id="summary-competitors">系統自動挑選中…</dd>
            </div>
          </dl>
          <div class="summary-actions">
            <button id="summary-confirm" type="button" class="btn btn--primary">確認設定，開始分析</button>
            <button id="summary-back" type="button" class="btn btn--secondary">返回問卷</button>
          </div>
        </div>
      </div>

      <div class="progress-dock">
        <div class="progress-dock__bar">
          <div id="progress-bar-s3" class="progress-dock__fill" style="width: 0%;"></div>
        </div>
        <div class="progress-dock__meta">
          <span id="progress-label-s3">AI 可見度分析中… 進度 0%</span>
          <span id="progress-eta-s3" class="muted">完成後我會即時通知你</span>
        </div>
      </div>
    </section>

    <!-- S4｜分析完成 -->
    <section id="stage-s4" class="stage" data-stage="s4" hidden>
      <div class="stage-panel stage-panel--result">
        <section class="result-hero">
          <div class="brand-line brand-line--compact">
            <img src="logo.png" alt="星級引擎" class="brand-line__logo" />
            <span class="brand-line__text">星級引擎｜脈動智匯</span>
          </div>
          <div class="result-hero__card">
            <div class="result-hero__copy">
              <h2>入場券初審完成！先看這份即時摘要</h2>
              <p class="muted">Cognos 已整合評論趨勢與可見度分數，以下三個指標幫你掌握入場券評估。</p>
            </div>
            <div class="result-hero__kpis">
              <article class="result-kpi">
                <span class="result-kpi__label">Google 星等</span>
                <strong class="result-kpi__value" id="result-kpi-rating">—</strong>
                <span class="result-kpi__hint" id="result-kpi-rating-hint">同步中</span>
              </article>
              <article class="result-kpi">
                <span class="result-kpi__label">評論數</span>
                <strong class="result-kpi__value" id="result-kpi-reviews">—</strong>
                <span class="result-kpi__hint" id="result-kpi-reviews-hint">整理評論細節</span>
              </article>
              <article class="result-kpi">
                <span class="result-kpi__label">競品差距</span>
                <strong class="result-kpi__value" id="result-kpi-gap">—</strong>
                <span class="result-kpi__hint" id="result-kpi-gap-hint">競品比較載入中</span>
              </article>
            </div>
          </div>
          <p class="result-hero__trust">AI 已保存你的語氣設定，正式入場券會沿用同樣的調性。</p>
          <div class="result-warning" id="result-warning" hidden>
            <strong>提醒：</strong>
            <span id="result-warning-text"></span>
          </div>
        </section>

        <div class="result-body result-grid">
          <article class="result-module result-card result-card--radar" id="result-radar">
            <header class="result-module__header">
              <h3>競品雷達</h3>
              <p class="muted">星等、評論量與距離差距即時更新</p>
            </header>
            <ul id="result-radar-list" class="result-list"></ul>
          </article>

          <article class="result-module result-card result-card--actions" id="result-actions">
            <header class="result-module__header">
              <h3>本週三件事</h3>
              <p class="muted">直接複製即可交派團隊執行</p>
            </header>
            <ul id="result-actions-list" class="result-list"></ul>
            <button id="copy-actions" type="button" class="btn btn--ghost">複製三件事</button>
          </article>

          <article class="result-module result-card result-card--drafts" id="result-drafts">
            <header class="result-module__header">
              <h3>三版回覆草稿</h3>
              <p class="muted">已套用你的語氣偏好，可一鍵複製</p>
            </header>
            <div id="result-drafts-list" class="drafts"></div>
          </article>
        </div>

        <div class="result-cta">
          <div class="result-cta__copy">
            <h3>需要更完整的細節？</h3>
            <p class="muted">完整報表與 AI 專業助理已準備好，隨時為你待命。</p>
          </div>
          <div class="result-cta__actions">
            <a id="cta-report" class="btn btn--primary result-actions__btn" href="#">查看入場券預覽</a>
            <a id="cta-assistant" class="btn btn--outline result-actions__btn" href="#" target="_blank" rel="noopener">生成正式入場券</a>
          </div>
        </div>
        <button id="return-home" type="button" class="btn btn--ghost result-return">返回主畫面</button>
      </div>
    </section>

    <!-- S5｜超時分支 -->
    <section id="stage-s5" class="stage" data-stage="s5" hidden>
      <div class="stage-panel stage-panel--timeout">
        <div class="brand-line brand-line--compact">
          <img src="logo.png" alt="星級引擎" class="brand-line__logo" />
          <span class="brand-line__text">星級引擎｜脈動智匯</span>
        </div>
        <header class="stage-panel__header">
          <span class="stage-tag stage-tag--warning">S5 · 已排程完成後推送</span>
          <h2>資料量稍大，我會幫你盯住進度</h2>
          <p class="muted">我已把任務排入佇列，完成後會立刻發送完整報表與提醒，同時保留你的語氣設定。</p>
        </header>

        <div class="timeout-card" id="timeout-card">
          <div class="timeout-card__row">
            <span class="timeout-card__spinner" id="timeout-spinner" aria-hidden="true"></span>
            <div class="timeout-card__body">
              <span class="timeout-card__eyebrow">Cognos 正在收尾</span>
              <h3 class="timeout-card__status" id="timeout-status-label">排程推送中</h3>
              <p class="timeout-card__note" id="timeout-note">Google 資料已就緒，評論補齊後會另行通知。</p>
              <div class="timeout-card__actions">
                <a id="timeout-report" class="btn btn--primary" href="#">查看完整報表</a>
                <a id="timeout-assistant" class="btn btn--outline" href="#" target="_blank" rel="noopener">AI 專業助理</a>
              </div>
            </div>
          </div>
        </div>
        <button id="timeout-back" type="button" class="btn btn--ghost timeout-back">返回主畫面</button>
      </div>
  </section>
</main>

  <footer class="footer-link">
    <a href="about.html?v=20251006T0054" id="about-link">關於我們</a>
  </footer>

  <div class="toast" id="toast" hidden></div>

  <script src="https://static.line-scdn.net/liff/edge/versions/2.21.2/sdk.js"></script>
  <script src="config.runtime.js?v=20251006T0054"></script>
  <script src="config.js?v=20251006T0054"></script>
  <script src="report-utils.js?v=20251006T0054"></script>
  <script src="analytics.js?v=20251006T0054"></script>
  <script src="app.js?v=20251006T0054"></script>
</body>
</html>
